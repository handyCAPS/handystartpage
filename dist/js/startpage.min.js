/*! handystartpage - v0.0.1 - 2014-04-02
* Copyright (c) 2014 Tim Doppenberg; Licensed  */
function hideTheForm(a){var b=a.parents("section"),c=b[0].id,d="#show"+c[0].toUpperCase()+c.substr(1);b.hide("fast"),$(d).fadeIn("slow")}function showAddLinkForm(){$("#addLinkForm").slideDown("slow"),$("#showAddLinkForm").fadeOut("fast"),$("#addLinkForm form input:first-of-type").focus()}function showAddCatForm(){$("#addCatForm").slideDown("slow"),$("#showAddCatForm").fadeOut("fast"),$("#addCatForm form input:first-of-type").focus()}function alignThePlusses(){$(".show-add-form").css({top:$("#bestof").innerHeight()+1.5*$(".show-add-form").outerHeight()})}function placeRangeWrap(){$(".range_wrap").css({top:$("#bestof").outerHeight(),right:0})}function placeTinyRangeWrap(){$(".range_wrap").css({top:"-8px",right:"-80px"})}function closeAfterForm(){$("#formWrap").animate({"min-height":"-=108px"},"slow")}function openForForm(){$("#formWrap").animate({"min-height":"+=108px"},"slow")}function listenForClicks(){$("a").on("click",function(a){var b=a.currentTarget.id.replace(/[^0-9]*/,"");$.post("scripts/update-clicks.php?id="+b,function(){window.location.reload()})})}function ajaxUploadImage(a){if(null!==document.location.search.match(/opdate/)){console.log("it does");var b="<div class='previmage'></div>";$("body").append(b),$(".previmage").css({display:"inline-block","background-color":"#CCC",position:"absolute",top:20});var c=new FormData;c.append("image",$(a.target)[0].files[0]),$.ajax({url:"scripts/upload-image.php",type:"POST",data:c,contentType:!1,processData:!1,success:function(a){var b=JSON.parse(a);if(b.hasOwnProperty("uploadErrors"))console.log(b.uploadErrors);else{var c="<img src='"+b.imgLocation+b.imgName+"' alt=''>";$(".previmage").html(c),$("#img_id")[0].value=b.imgId}}})}}function timingOut(a){var b=new jQuery.Deferred;return setTimeout(function(){b.resolve()},a),b.promise()}function showRangeSelector(a){placeRangeWrap(),$.when(timingOut(a)).done(function(){var a=$("#bestOfRange"),b=$(".range_display"),c=$(".range_wrap");a.show("slow"),b.animate({opacity:1}),$(".close").css({opacity:1}),c.addClass("range_label"),b.html(a.val()),$.when(timingOut(2e3)).done(function(){c.addClass("tiny"),c.removeClass("range_label"),placeTinyRangeWrap()}),a.on("input",function(){b.html($(this).val())}),$(".range_wrap .close").on("click",function(){c.addClass("tiny"),placeTinyRangeWrap()}),a.on("change",function(){$("#bestOfWrap").load("scripts/update-bestof.php",{bestOfRange:a.val()},function(){listenForClicks(),placeRangeWrap(),alignThePlusses()})}),a.on("mouseover",function(){$(".tiny").removeClass("tiny"),placeRangeWrap()})})}function checkCookie(a){var b=new RegExp(a),c=document.cookie,d=c.match(b);return d?d.index:d}function getCookieValue(a){var b=checkCookie(a);return b>=0?parseFloat(document.cookie.substr(b+a.length)):!1}function hoverButtonsOnLoad(){$.when(timingOut(800)).done(function(){var a="howManyLoads=",b=getCookieValue(a)||0;if(b++,document.cookie=a+b+";max-age=60",b>1||""!==window.location.search)return showRangeSelector(500),this.fail();var c=$(".show-add-form"),d=0,e=c.length,f=$(c).offset().left,g=[];for(c.addClass("hovered");e>d;d++){var h,i=c[d].title,j="#"+c[d].id,k="#af"+c[d].id;$("body").append('<div class="add-form-title" id="'+k.replace("#","")+'">'+i+"</div>");var l=$(j).offset().left;l>f?(f=l,h=l-($(k).innerWidth()+16)):h=l+40,$(k).animate({top:$(j).offset().top-16,left:h,opacity:1}),g.push(k)}$.when(timingOut(1200)).done(function(){c.removeClass("hovered");for(var a=0;a<g.length;a++)$(g[a]).fadeOut(2800)})})}$(window).on("resize",function(){alignThePlusses()}),$(".desc").on("focusin",function(a){$(this).animate({height:"+=119px",width:"+=40px"}),"No Description Available"===$(this).html()?$(this).select():a.currentTarget.selectionStart=$(this).html().length}),$(".desc").on("focusout",function(){$(this).animate({height:"-=119px",width:"-=40px"})}),$(".closexWrap").on("click",function(){var a=$(this);hideTheForm(a),closeAfterForm()}),$("#showAddLinkForm").on("click",function(){openForForm(),showAddLinkForm()}),$("#showAddCatForm").on("click",function(){openForForm(),showAddCatForm()}),$("body").on("keypress",function(a){113===a.charCode&&a.altKey===!0?showAddLinkForm():99===a.charCode&&a.altKey===!0&&showAddCatForm()}),$(".delete-button").on("click",function(){confirm("Sure ?")&&$.post("scripts/delete-link.php?id="+$(this).siblings('[name="id"]')[0].value,function(){window.location.reload()})}),$(".clear-clicks").on("click",function(a){confirm("Are you sure you want to reset all the clicks to 0 ?")||a.preventDefault()}),$('input[name="image"]').on("mouseover focusout",function(a){function b(d,e){var g=window.location.search.match("update");"undefined"==typeof window.$(".preview-image")[0]?($("body").append(d),"mouseover"===a.type?$(e).css({top:a.pageY-60,left:a.pageX+24}):"focusout"!==a.type||g||$(e).css({top:c,right:12})):($(".preview-image").remove(),b(d,f))}var c=parseFloat(a.currentTarget.offsetTop),d="prev"+$(this).parent().context.id,e="<div class='preview-image' id='"+d+"'><img src='dist/images/"+$(this)[0].defaultValue+"' alt=''></div>",f="#"+d;b(e,f)}),$('input[name="image"]').on("mouseout focusin",function(){var a="#prev"+$(this).parent().context.id;$(a).remove()}),$(".image-input").on("focusout",function(a){ajaxUploadImage(a)}),$(document).ready(function(){var a=$("#innerWrap");a.masonry({itemSelector:".sub-sections"}),alignThePlusses(),hoverButtonsOnLoad(),showRangeSelector(5e3),listenForClicks()});